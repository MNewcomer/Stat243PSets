<!DOCTYPE html>
<!-- saved from url=(0088)file:///D:/Users/Michelle%20Newcomer/Documents/GitHub/Stat243PSets/PS2/Newcomer_PS2.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<title>Problem Set 2</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>




</head>

<body>
<h1>Problem Set 2</h1>

<h1>Michelle Newcomer</h1>

<h1>Stat 242 Fall 2013</h1>

<h3>Problem 1</h3>

<p>a) Explain why the result of this is a vector of length 8.</p>

<p>The vector is length 8 because we assigned this to a, which is located in the global environment. It does not matter what value of data we give to the function WrapFun1 because genFun1 is located outside of the local environment enclosed by WrapFun1. a gets assigned a different value by WrapFun1 only in the local environment.There is no input to return(genFun1()) which would assign a different number to a so genFun1 looks in the global environment for a.</p>

<p>b) Now explain why the result of this is a vector of length 3.</p>

<p>The vector is now length 3 because we assined the lengh of the data to vector a (which is only available in the local environment) and then passed a to genFun2 which made it available in the global environment.</p>

<p>c) And why this is a vector of length 16.</p>

<p>This returns a vector of length 16 because the length of data is not passed from the local to the global environment. a gets assigned the length(data) only locally. Thus x is assigned the value a*2 and whatever a is available in the global environment is what is used.</p>

<h3>Problem 2</h3>

<p>The code below accesses four different frames. The first is the global environment, the second is the environment inside sapply, the third is the function enviornment, and the fourth is the environement defined by x only within the ls() function. In the first frame, all of the variables in the workspace are available. In the second frame, only the functions, and objects defining the function are available. The third frame contains only the function and the variable x, while the fourth frame containes only the variable x. </p>

<pre><code class="r">
<span class="comment"># original</span>
<span class="identifier">sapply</span><span class="paren">(</span><span class="number">0</span><span class="operator">:</span><span class="number">3</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span>
    <span class="identifier">ls</span><span class="paren">(</span><span class="identifier">envir</span> <span class="operator">=</span> <span class="identifier">sys.frame</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span>
<span class="paren">}</span><span class="paren">)</span>
</code></pre>

<pre><code>## [[1]]
## character(0)
## 
## [[2]]
##  [1] "apat"      "con"       "encoding"  "envir"     "ext"      
##  [6] "in.file"   "input"     "input.dir" "input2"    "ocode"    
## [11] "oconc"     "oenvir"    "oopts"     "opat"      "optc"     
## [16] "optk"      "output"    "pattern"   "progress"  "quiet"    
## [21] "tangle"    "text"     
## 
## [[3]]
##  [1] "group"  "groups" "i"      "n"      "olines" "output" "pb"    
##  [8] "res"    "tangle" "text"  
## 
## [[4]]
## [1] "classes"   "expr"      "handlers"  "parentenv"
</code></pre>

<pre><code class="r"><span class="comment"># break this down into different parts</span>
<span class="identifier">fun</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span>
    <span class="identifier">ls</span><span class="paren">(</span><span class="identifier">envir</span> <span class="operator">=</span> <span class="identifier">sys.frame</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span>
    <span class="identifier">print</span><span class="paren">(</span><span class="identifier">sys.frame</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span>
<span class="paren">}</span>


<span class="comment"># try to reproduce the behavior use sapply with each number</span>
<span class="identifier">a</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span><span class="paren">(</span><span class="number">0</span>, <span class="identifier">fun</span><span class="paren">)</span>
</code></pre>

<pre><code>## &lt;environment: R_GlobalEnv&gt;
</code></pre>

<pre><code class="r"><span class="identifier">b</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span><span class="paren">(</span><span class="number">1</span>, <span class="identifier">fun</span><span class="paren">)</span>
</code></pre>

<pre><code>## &lt;environment: 0x00000000077608a0&gt;
</code></pre>

<pre><code class="r"><span class="identifier">d</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span><span class="paren">(</span><span class="number">2</span>, <span class="identifier">fun</span><span class="paren">)</span>
</code></pre>

<pre><code>## &lt;environment: 0x0000000007d43fd8&gt;
</code></pre>

<pre><code class="r"><span class="identifier">e</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span><span class="paren">(</span><span class="number">3</span>, <span class="identifier">fun</span><span class="paren">)</span>
</code></pre>

<pre><code>## &lt;environment: 0x0000000008192a28&gt;
</code></pre>

<h3>Problem 3</h3>

<p>I accomplished this task using both UNIX and R tools: </p>

<pre><code class="r"><span class="comment">#! /bin/bash</span>
<span class="identifier">echo</span> <span class="string">"Please enter the number of samples then press enter: "</span>
<span class="identifier">read</span> <span class="identifier">input_n</span>
<span class="identifier">echo</span> <span class="string">"You entered: $input_n. Please wait for approximately 3 minutes."</span>
<span class="identifier">IFS</span><span class="operator">=</span><span class="operator">:</span> <span class="comment"># internal field separator</span>
<span class="identifier">number</span><span class="operator">=</span><span class="operator">$</span><span class="identifier">input_n</span> <span class="comment"># this specifies the number of samples</span>
<span class="identifier">set</span> <span class="identifier">seed</span> <span class="operator">=</span> <span class="number">1</span>

<span class="comment"># this next line does many things. First it looks at the .bz2 files and grabs only the lines that start with H. Then it reads the lines and appends a random number to each line. </span>
<span class="comment"># It sorts the lines and then cuts off the appended numbers and obtains only the first number of lines that was specified by the user.</span>
 <span class="comment"># this particular line takes about 3 minutes</span>

<span class="identifier">bzcat</span> <span class="identifier">PUMS5_06.TXT.bz2</span> <span class="operator">|</span> <span class="identifier">grep</span> <span class="operator">^</span><span class="identifier">H</span> <span class="operator">|</span> <span class="keyword">while</span> <span class="identifier">IFS</span><span class="operator">=</span> <span class="identifier">read</span> <span class="operator">-</span><span class="identifier">r</span> <span class="identifier">f</span>; <span class="identifier">do</span> <span class="identifier">printf</span> <span class="string">"%05d %s\n"</span> <span class="string">"$RANDOM"</span> <span class="string">"$f"</span>; <span class="identifier">done</span> <span class="operator">|</span> <span class="identifier">sort</span> <span class="operator">-</span><span class="identifier">n</span> <span class="operator">|</span> <span class="identifier">cut</span> <span class="operator">-</span><span class="identifier">c7</span><span class="operator">-</span> <span class="operator">|</span> <span class="identifier">head</span> <span class="operator">-</span><span class="identifier">n</span> <span class="operator">$</span><span class="identifier">number</span> <span class="operator">&gt;</span> <span class="identifier">linesForR.txt</span>

.<span class="operator">/</span><span class="identifier">subset.R</span> <span class="operator">$</span><span class="identifier">number</span>
</code></pre>

<p>And here is the R code named subset.R that the UNIX shell file calls</p>

<pre><code class="r"><span class="comment"># ! /usr/bin/Rscript</span>

<span class="identifier">args</span> <span class="operator">&lt;-</span> <span class="identifier">commandArgs</span><span class="paren">(</span><span class="literal">TRUE</span><span class="paren">)</span>

<span class="identifier">numericArg</span> <span class="operator">&lt;-</span> <span class="identifier">as.numeric</span><span class="paren">(</span><span class="identifier">args</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span>
<span class="identifier">charArg</span> <span class="operator">&lt;-</span> <span class="identifier">read.table</span><span class="paren">(</span><span class="string">"linesForR.txt"</span>, <span class="identifier">sep</span> <span class="operator">=</span> <span class="string">"\t"</span>, <span class="identifier">head</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span>
<span class="identifier">class</span><span class="paren">(</span><span class="identifier">charArg</span><span class="paren">)</span>

<span class="comment"># this set of code initializes the vectors</span>
<span class="identifier">BEDRMS</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="identifier">rep</span><span class="paren">(</span><span class="literal">NA</span>, <span class="identifier">args</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">FINC</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="identifier">rep</span><span class="paren">(</span><span class="literal">NA</span>, <span class="identifier">args</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">NPF</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="identifier">rep</span><span class="paren">(</span><span class="literal">NA</span>, <span class="identifier">args</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">ROOMS</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="identifier">rep</span><span class="paren">(</span><span class="literal">NA</span>, <span class="identifier">args</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">HHT</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="identifier">rep</span><span class="paren">(</span><span class="literal">NA</span>, <span class="identifier">args</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">P18</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="identifier">rep</span><span class="paren">(</span><span class="literal">NA</span>, <span class="identifier">args</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">P65</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="identifier">rep</span><span class="paren">(</span><span class="literal">NA</span>, <span class="identifier">args</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span>


<span class="keyword">for</span> <span class="paren">(</span><span class="identifier">i</span> <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="identifier">args</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span> <span class="paren">{</span>

    <span class="identifier">BEDRMS</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">as.numeric</span><span class="paren">(</span><span class="identifier">substring</span><span class="paren">(</span><span class="identifier">charArg</span><span class="paren">[</span><span class="identifier">i</span>, <span class="number">1</span><span class="paren">]</span>, <span class="number">124</span>, <span class="number">124</span><span class="paren">)</span><span class="paren">)</span>
    <span class="identifier">FINC</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">as.numeric</span><span class="paren">(</span><span class="identifier">substring</span><span class="paren">(</span><span class="identifier">charArg</span><span class="paren">[</span><span class="identifier">i</span>, <span class="number">1</span><span class="paren">]</span>, <span class="number">259</span>, <span class="number">266</span><span class="paren">)</span><span class="paren">)</span>
    <span class="identifier">NPF</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">as.numeric</span><span class="paren">(</span><span class="identifier">substring</span><span class="paren">(</span><span class="identifier">charArg</span><span class="paren">[</span><span class="identifier">i</span>, <span class="number">1</span><span class="paren">]</span>, <span class="number">218</span>, <span class="number">219</span><span class="paren">)</span><span class="paren">)</span>
    <span class="identifier">ROOMS</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">as.numeric</span><span class="paren">(</span><span class="identifier">substring</span><span class="paren">(</span><span class="identifier">charArg</span><span class="paren">[</span><span class="identifier">i</span>, <span class="number">1</span><span class="paren">]</span>, <span class="number">122</span>, <span class="number">122</span><span class="paren">)</span><span class="paren">)</span>
    <span class="identifier">HHT</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">as.factor</span><span class="paren">(</span><span class="identifier">substring</span><span class="paren">(</span><span class="identifier">charArg</span><span class="paren">[</span><span class="identifier">i</span>, <span class="number">1</span><span class="paren">]</span>, <span class="number">213</span>, <span class="number">213</span><span class="paren">)</span><span class="paren">)</span>
    <span class="identifier">P18</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">as.numeric</span><span class="paren">(</span><span class="identifier">substring</span><span class="paren">(</span><span class="identifier">charArg</span><span class="paren">[</span><span class="identifier">i</span>, <span class="number">1</span><span class="paren">]</span>, <span class="number">216</span>, <span class="number">217</span><span class="paren">)</span><span class="paren">)</span>
    <span class="identifier">P65</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">as.numeric</span><span class="paren">(</span><span class="identifier">substring</span><span class="paren">(</span><span class="identifier">charArg</span><span class="paren">[</span><span class="identifier">i</span>, <span class="number">1</span><span class="paren">]</span>, <span class="number">214</span>, <span class="number">215</span><span class="paren">)</span><span class="paren">)</span>
<span class="paren">}</span>

<span class="identifier">subset</span> <span class="operator">&lt;-</span> <span class="identifier">data.frame</span><span class="paren">(</span><span class="identifier">BEDRMS</span>, <span class="identifier">FINC</span>, <span class="identifier">NPF</span>, <span class="identifier">ROOMS</span>, <span class="identifier">HHT</span>, <span class="identifier">P18</span>, <span class="identifier">P65</span><span class="paren">)</span>
<span class="identifier">subset</span>

</code></pre>

<p>Here is an example of the output to the screen</p>

<pre><code class="r"><span class="identifier">BEDRMS</span>  <span class="identifier">FINC</span> <span class="identifier">NPF</span> <span class="identifier">ROOMS</span> <span class="identifier">HHT</span> <span class="identifier">P18</span> <span class="identifier">P65</span>
<span class="number">1</span>      <span class="number">1</span> <span class="number">14000</span>   <span class="number">4</span>     <span class="number">2</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">0</span>
<span class="number">2</span>      <span class="number">2</span>     <span class="number">0</span>   <span class="number">0</span>     <span class="number">4</span>   <span class="number">1</span>   <span class="number">0</span>   <span class="number">0</span>
<span class="number">3</span>      <span class="number">1</span> <span class="number">13500</span>   <span class="number">3</span>     <span class="number">3</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">0</span>
<span class="number">4</span>      <span class="number">2</span>     <span class="number">0</span>   <span class="number">0</span>     <span class="number">6</span>   <span class="number">1</span>   <span class="number">0</span>   <span class="number">1</span>
<span class="number">5</span>      <span class="number">0</span>     <span class="number">0</span>   <span class="number">0</span>     <span class="number">1</span>   <span class="number">1</span>   <span class="number">0</span>   <span class="number">1</span>
<span class="number">6</span>      <span class="number">1</span>     <span class="number">0</span>   <span class="number">0</span>     <span class="number">3</span>   <span class="number">1</span>   <span class="number">0</span>   <span class="number">0</span>
<span class="number">7</span>     <span class="literal">NA</span>     <span class="number">0</span>   <span class="number">0</span>    <span class="literal">NA</span>   <span class="number">1</span>   <span class="number">0</span>   <span class="number">0</span>

</code></pre>

<h3>Problem 4</h3>

<p>For the analysis of Shakespeare's plays, structural data about each play, person, and chunk of speech was gathered from a text file. The year, title, number of acts, number of scenes, length of each chunk of speech, number of characters, total word count, average number of words per chunk, and standard deviation of the number of words per chunk were analyzed. </p>

<pre><code class="r"><span class="keyword">library</span><span class="paren">(</span><span class="identifier">stringr</span><span class="paren">)</span>
<span class="identifier">text</span> <span class="operator">&lt;-</span> <span class="identifier">scan</span><span class="paren">(</span><span class="string">"Shakespeare.txt"</span>, <span class="identifier">character</span><span class="paren">(</span><span class="number">0</span><span class="paren">)</span>, <span class="identifier">quote</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="identifier">sep</span> <span class="operator">=</span> <span class="string">"\t"</span><span class="paren">)</span>

<span class="identifier">start</span> <span class="operator">&lt;-</span> <span class="identifier">as.integer</span><span class="paren">(</span><span class="identifier">grep</span><span class="paren">(</span><span class="string">"^[[:digit:]]{4}"</span>, <span class="identifier">text</span>, <span class="identifier">perl</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">end</span> <span class="operator">&lt;-</span> <span class="identifier">as.integer</span><span class="paren">(</span><span class="identifier">grep</span><span class="paren">(</span><span class="string">"THE END"</span>, <span class="identifier">text</span>, <span class="identifier">perl</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">len_s</span> <span class="operator">&lt;-</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">start</span><span class="paren">)</span>

<span class="comment"># places each play into a list</span>
<span class="identifier">plays</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="paren">)</span>

<span class="keyword">for</span> <span class="paren">(</span><span class="identifier">i</span> <span class="keyword">in</span> <span class="number">2</span><span class="operator">:</span><span class="paren">(</span><span class="identifier">len_s</span> <span class="operator">-</span> <span class="number">1</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span>
    <span class="identifier">plays</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">i</span> <span class="operator">-</span> <span class="number">1</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">text</span><span class="paren">[</span><span class="identifier">start</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="operator">:</span><span class="identifier">end</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">]</span>
<span class="paren">}</span>

<span class="identifier">plays</span><span class="paren">[</span><span class="paren">[</span><span class="number">4</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="literal">NULL</span>  <span class="comment">#this removes the fourth play which is problematic</span>
<span class="identifier">len_p</span> <span class="operator">&lt;-</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">plays</span><span class="paren">)</span>

<span class="comment"># places the year into a vector</span>
<span class="identifier">year</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="paren">)</span>
<span class="keyword">for</span> <span class="paren">(</span><span class="identifier">i</span> <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="identifier">len_p</span><span class="paren">)</span> <span class="paren">{</span>
    <span class="identifier">year</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">as.integer</span><span class="paren">(</span><span class="identifier">plays</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">]</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span>
<span class="paren">}</span>

<span class="comment"># places the title into a vector</span>
<span class="identifier">title</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="paren">)</span>
<span class="keyword">for</span> <span class="paren">(</span><span class="identifier">i</span> <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="identifier">len_p</span><span class="paren">)</span> <span class="paren">{</span>
    <span class="identifier">title</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">as.character</span><span class="paren">(</span><span class="identifier">plays</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">]</span><span class="paren">[</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span>
<span class="paren">}</span>

<span class="comment"># this function finds all of the acts and scenes</span>
<span class="identifier">acts</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="paren">)</span>

<span class="identifier">findActs</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span>
    <span class="identifier">numActsTmp</span> <span class="operator">&lt;-</span> <span class="paren">(</span><span class="identifier">grep</span><span class="paren">(</span><span class="string">"^ACT"</span>, <span class="identifier">plays</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">x</span><span class="paren">]</span><span class="paren">]</span>, <span class="identifier">perl</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">ignore.case</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span><span class="paren">)</span>
    <span class="identifier">len_a</span> <span class="operator">&lt;-</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">numActsTmp</span><span class="paren">)</span>

    <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">i</span> <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="identifier">len_a</span><span class="paren">)</span> <span class="paren">{</span>
        <span class="identifier">acts</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">as.character</span><span class="paren">(</span><span class="identifier">plays</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">x</span><span class="paren">]</span><span class="paren">]</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">numActsTmp</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span>
    <span class="paren">}</span>

    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">acts</span><span class="paren">)</span>
<span class="paren">}</span>

<span class="comment"># count the number of acts and scenes for each play. Counting the number</span>
<span class="comment"># of times scene 1 occurs provides the number of Acts. Counting the number</span>
<span class="comment"># of time Act appears provides the number of scenes</span>
<span class="identifier">numScenes</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="paren">)</span>
<span class="identifier">numActs</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="paren">)</span>

<span class="keyword">for</span> <span class="paren">(</span><span class="identifier">i</span> <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="identifier">len_p</span><span class="paren">)</span> <span class="paren">{</span>
    <span class="identifier">tmp</span> <span class="operator">&lt;-</span> <span class="identifier">findActs</span><span class="paren">(</span><span class="identifier">i</span><span class="paren">)</span>
    <span class="identifier">numActs</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">grep</span><span class="paren">(</span><span class="string">"Scene 1|Scene I|(?&lt;=\\SC_)([1]$)"</span>, <span class="identifier">tmp</span>, <span class="identifier">perl</span> <span class="operator">=</span> <span class="literal">TRUE</span>, 
        <span class="identifier">ignore.case</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span><span class="paren">)</span>
    <span class="identifier">numScenes</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">tmp</span><span class="paren">)</span>
<span class="paren">}</span>


<span class="comment"># find their chunks of speech</span>

<span class="identifier">tmp_chunks</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="paren">)</span>

<span class="identifier">findChunks</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span>
    <span class="identifier">tmp_chunks</span> <span class="operator">&lt;-</span> <span class="identifier">grep</span><span class="paren">(</span><span class="string">"^([[:space:]]{2,}+[[:upper:]]{4,30}\\.)"</span>, <span class="identifier">plays</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">x</span><span class="paren">]</span><span class="paren">]</span>, 
        <span class="identifier">perl</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">ignore.case</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span>
    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">tmp_chunks</span><span class="paren">)</span>
<span class="paren">}</span>

<span class="identifier">chunks</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="paren">)</span>
<span class="keyword">for</span> <span class="paren">(</span><span class="identifier">i</span> <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">plays</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span>
    <span class="identifier">chunks</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">findChunks</span><span class="paren">(</span><span class="identifier">i</span><span class="paren">)</span>
<span class="paren">}</span>

<span class="identifier">len_chunk</span> <span class="operator">&lt;-</span> <span class="identifier">as.integer</span><span class="paren">(</span><span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">chunks</span>, <span class="identifier">length</span><span class="paren">)</span><span class="paren">)</span>

<span class="comment"># formatting chunks of dialogue and binding lines of speech together</span>
<span class="identifier">lines</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="paren">)</span>
<span class="identifier">replace</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="paren">)</span>
<span class="identifier">aggregate</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="paren">)</span>

<span class="identifier">findPeople</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span>
    <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">i</span> <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">chunks</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">x</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span>
        <span class="identifier">lines</span> <span class="operator">&lt;-</span> <span class="identifier">plays</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">x</span><span class="paren">]</span><span class="paren">]</span><span class="paren">[</span><span class="identifier">chunks</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">x</span><span class="paren">]</span><span class="paren">]</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">]</span><span class="operator">:</span><span class="paren">(</span><span class="identifier">chunks</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">x</span><span class="paren">]</span><span class="paren">]</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">-</span> <span class="number">1</span><span class="paren">)</span><span class="paren">]</span>
        <span class="identifier">replace</span> <span class="operator">&lt;-</span> <span class="identifier">str_replace_all</span><span class="paren">(</span><span class="identifier">string</span> <span class="operator">=</span> <span class="identifier">lines</span>, <span class="identifier">pattern</span> <span class="operator">=</span> <span class="string">"  "</span>, <span class="identifier">repl</span> <span class="operator">=</span> <span class="string">""</span><span class="paren">)</span>
        <span class="identifier">aggregate</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">paste</span><span class="paren">(</span><span class="identifier">replace</span>, <span class="identifier">collapse</span> <span class="operator">=</span> <span class="string">" "</span><span class="paren">)</span>
    <span class="paren">}</span>
    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">aggregate</span><span class="paren">)</span>
<span class="paren">}</span>

<span class="identifier">speech</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="paren">)</span>
<span class="keyword">for</span> <span class="paren">(</span><span class="identifier">i</span> <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">plays</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span>
    <span class="identifier">speech</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">findPeople</span><span class="paren">(</span><span class="identifier">i</span><span class="paren">)</span>
<span class="paren">}</span>

<span class="comment"># finding the individual speakers and their chunks of text this function</span>
<span class="comment"># places each person into a list, and places each person's spoken text</span>
<span class="comment"># into a list.</span>
<span class="identifier">unique_Speech</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="paren">)</span>
<span class="identifier">unique_lines</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="paren">)</span>
<span class="identifier">len_unique</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="paren">)</span>
<span class="identifier">len_numPeop</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="paren">)</span>
<span class="identifier">unique</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="paren">)</span>
<span class="identifier">unique_peop</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="paren">)</span>

<span class="identifier">uniqueSpeech</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span>
    <span class="identifier">matches</span> <span class="operator">&lt;-</span> <span class="identifier">gregexpr</span><span class="paren">(</span><span class="string">"^([[:upper:]]{4,20}\\.)"</span>, <span class="identifier">speech</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">x</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span>
    <span class="identifier">names</span> <span class="operator">&lt;-</span> <span class="identifier">regmatches</span><span class="paren">(</span><span class="identifier">speech</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">x</span><span class="paren">]</span><span class="paren">]</span>, <span class="identifier">matches</span><span class="paren">)</span>
    <span class="identifier">unique</span> <span class="operator">&lt;-</span> <span class="identifier">unique.default</span><span class="paren">(</span><span class="identifier">sapply</span><span class="paren">(</span><span class="identifier">names</span>, <span class="identifier">unique</span><span class="paren">)</span><span class="paren">)</span>
    <span class="identifier">len_unique</span> <span class="operator">&lt;-</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">unique</span><span class="paren">)</span>

    <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">i</span> <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="identifier">len_unique</span><span class="paren">)</span> <span class="paren">{</span>
        <span class="identifier">lines</span> <span class="operator">&lt;-</span> <span class="identifier">as.integer</span><span class="paren">(</span><span class="identifier">grep</span><span class="paren">(</span><span class="identifier">unique</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span>, <span class="identifier">speech</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">x</span><span class="paren">]</span><span class="paren">]</span>, <span class="identifier">perl</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">ignore.case</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span><span class="paren">)</span>
        <span class="identifier">unique_lines</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">speech</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">x</span><span class="paren">]</span><span class="paren">]</span><span class="paren">[</span><span class="identifier">lines</span><span class="paren">[</span><span class="paren">]</span><span class="paren">]</span>
    <span class="paren">}</span>
    <span class="identifier">result</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span><span class="identifier">unique_lines</span>, <span class="identifier">len_unique</span><span class="paren">)</span>
    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">result</span><span class="paren">)</span>
<span class="paren">}</span>


<span class="keyword">for</span> <span class="paren">(</span><span class="identifier">i</span> <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">speech</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span>
    <span class="identifier">func</span> <span class="operator">&lt;-</span> <span class="identifier">uniqueSpeech</span><span class="paren">(</span><span class="identifier">i</span><span class="paren">)</span>
    <span class="identifier">len_numPeop</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">as.integer</span><span class="paren">(</span><span class="identifier">func</span><span class="paren">[</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">func</span><span class="paren">)</span><span class="paren">]</span><span class="paren">)</span>
    <span class="identifier">unique_Speech</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">func</span><span class="paren">[</span><span class="number">1</span><span class="operator">:</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">func</span><span class="paren">)</span> <span class="operator">-</span> <span class="number">1</span><span class="paren">)</span><span class="paren">]</span>
<span class="paren">}</span>

<span class="comment"># count the number of words, find the average and standard deviation</span>
<span class="identifier">word_count</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span><span class="paren">(</span><span class="identifier">gregexpr</span><span class="paren">(</span><span class="string">"\\W+"</span>, <span class="identifier">unique_Speech</span><span class="paren">)</span>, <span class="identifier">length</span><span class="paren">)</span> <span class="operator">+</span> <span class="number">1</span>

<span class="identifier">word_chunk</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="paren">)</span>
<span class="identifier">word_avg</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="paren">)</span>
<span class="identifier">word_sd</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="paren">)</span>

<span class="keyword">for</span> <span class="paren">(</span><span class="identifier">i</span> <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">unique_Speech</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span>
    <span class="identifier">word_chunk</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span><span class="paren">(</span><span class="identifier">gregexpr</span><span class="paren">(</span><span class="string">"\\W+"</span>, <span class="identifier">unique_Speech</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span>, <span class="identifier">length</span><span class="paren">)</span> <span class="operator">+</span> <span class="number">1</span>
    <span class="identifier">word_avg</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">sum</span><span class="paren">(</span><span class="identifier">word_chunk</span><span class="operator">/</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">unique_Speech</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span>
    <span class="identifier">word_sd</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">sd</span><span class="paren">(</span><span class="identifier">word_chunk</span><span class="paren">)</span>
<span class="paren">}</span>

<span class="identifier">df</span> <span class="operator">&lt;-</span> <span class="identifier">data.frame</span><span class="paren">(</span><span class="identifier">year</span>, <span class="identifier">title</span>, <span class="identifier">numActs</span>, <span class="identifier">numScenes</span>, <span class="identifier">len_chunk</span>, <span class="identifier">len_numPeop</span>, <span class="identifier">word_count</span>, 
    <span class="identifier">word_avg</span>, <span class="identifier">word_sd</span><span class="paren">)</span>
</code></pre>

<p>Here is the first few entries of the dataframe:</p>

<pre><code class="r"><span class="identifier">head</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span>
</code></pre>

<pre><code>##   year                                    title numActs numScenes
## 1 1603                 ALLS WELL THAT ENDS WELL       5        23
## 2 1607      THE TRAGEDY OF ANTONY AND CLEOPATRA       5        33
## 3 1601                           AS YOU LIKE IT       5         5
## 4 1608                THE TRAGEDY OF CORIOLANUS       5         5
## 5 1609                                CYMBELINE       5         5
## 6 1604 THE TRAGEDY OF HAMLET, PRINCE OF DENMARK       5         5
##   len_chunk len_numPeop word_count word_avg word_sd
## 1       835          17      19169   1128.5  1169.7
## 2      1138          45      25822    574.8   984.6
## 3       796          21      20476    976.0  1350.1
## 4       899          29      18353    633.8   793.7
## 5       806          27      16237    602.3   594.1
## 6       432           2        553    276.5   386.8
</code></pre>

<p>Here is a plot of the number of characters over time:</p>

<pre><code class="r"><span class="identifier">plot</span><span class="paren">(</span><span class="identifier">df</span><span class="operator">$</span><span class="identifier">year</span>, <span class="identifier">df</span><span class="operator">$</span><span class="identifier">len_numPeop</span><span class="paren">)</span>
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-8"> </p>

<pre><code class="r"><span class="identifier">plot</span><span class="paren">(</span><span class="identifier">df</span><span class="operator">$</span><span class="identifier">year</span>, <span class="identifier">df</span><span class="operator">$</span><span class="identifier">len_chunk</span><span class="paren">)</span>
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-8"> </p>

<pre><code class="r"><span class="identifier">plot</span><span class="paren">(</span><span class="identifier">df</span><span class="operator">$</span><span class="identifier">year</span>, <span class="identifier">df</span><span class="operator">$</span><span class="identifier">word_count</span><span class="paren">)</span>
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-8"> </p>





</body></html>